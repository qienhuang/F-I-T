preregistration:
  case_id: dual_oracle_active_acquisition_v0_7
  parent_case_id: afdb_swissprot_tier2p11_confidence_regimes
  pack_version: v0.7_repo_ready
  date_locked: '2026-01-24'
  intent:
    primary_training_target: joint_low_fpr_usability_two_alarms_under_two_oracle_budgets
    secondary_training_targets:
    - msadepth_as_estimable_channel_C3_hat
    - batch_diversity_within_oracle_selection
    - allocation_policy_without_holdout_leakage
    - joint_gap_allocation_strategy
    non_claims:
    - No biological claims; protocol only
    - Holdout labels are used only for reporting, not for policy decisions
boundary:
  feature_whitelist:
  - length
  - I1_hi_conf_frac
  - I2_mean_plddt
  - I3_plddt_entropy
  - C1_low_conf_frac
  oracle_fields:
    pae_value: C2_pae_offdiag
    msa_depth: msa_depth
  thresholds:
    tau_pae: 10.0
    tau_msa_depth: 32
  universe_mode: union
  train_boundary:
    features: B0_only
    labels: PAE_and_MSA_oracles_revealed_on_query
    out_of_scope:
    - PAE_as_feature
    - MSA_as_feature
  deploy_boundary:
    features: B0_only
    labels: none
    out_of_scope:
    - PAE
    - MSA
  data_filters:
    min_length: 50
    max_length: 2500
    drop_na_features: true
    drop_na_oracles: false
data:
  input_metrics_path: ../../out/<B2_RUN_ID>/metrics_per_protein.parquet
  input_format_fallback: csv
  id_field: accession
  seed_string: FIT_DUAL_ORACLE_ACTIVE_V0.7
evaluation:
  holdout_frac: 0.2
  holdout_role: reporting_only
monitorability:
  fpr_targets:
  - 0.01
  - 0.05
  primary_fpr_target: 0.01
  threshold_selection_split: labeled_val
  rule: maximize_tpr_under_fpr_cap
  usable_epsilon_fpr: 0.0
  tpr_min_for_usable: 0.01
policy_diagnostics:
  use_split: labeled_val
  gap_definition:
    w_tpr: 1.0
    w_fpr: 5.0
model:
  pae_classifier:
    family: logistic_regression
    standardize: true
    impute_strategy: median
    params:
      C: 1.0
      max_iter: 2000
      class_weight: balanced
      solver: lbfgs
    min_labeled_to_train: 200
  msa_classifier:
    family: logistic_regression
    standardize: true
    impute_strategy: median
    params:
      C: 1.0
      max_iter: 2000
      class_weight: balanced
      solver: lbfgs
    min_labeled_to_train: 200
  msa_regressor:
    family: ridge_regression
    standardize: true
    impute_strategy: median
    params:
      alpha: 1.0
    min_labeled_to_train: 200
split_labeled:
  train_frac: 0.8
  val_frac: 0.2
acquisition:
  rounds: 20
  oracle_budgets:
    pae_total: 5000
    msa_total: 5000
  init_labeled:
    pae_n: 500
    msa_n: 500
  batch:
    mode: total
    total_per_round: 400
    fixed_split:
      pae_per_round: 200
      msa_per_round: 200
  policy_specs:
  - fixed_split__uncertainty
  - fixed_split__composite_batch_ff
  - adaptive_uncertainty__uncertainty
  - adaptive_uncertainty__composite_batch_ff
  - adaptive_joint_minimax__composite_batch_ff
  - adaptive_joint_gap__composite_batch_ff
  - random_hash__random_hash
  ranking:
    candidate_pool_cap:
      PAE: 5000
      MSA: 5000
    candidate_pool_basis: uncertainty
    composite_alpha: 0.7
    novelty_metric: euclidean_z
    fallback_if_no_model: random_hash
  tie_breaker: stable_hash
event:
  W_jump_rounds: 3
  delta_tpr: 0.05
outputs:
  out_root: out
  run_id_style: timestamp
  artifacts:
  - PREREG.locked.yaml
  - dataset_snapshot.json
  - boundary_snapshot.json
  - decision_trace.csv
  - allocation_trace.csv
  - round_metrics.json
  - eval_report.md
  - tradeoff_onepage.pdf
  - run_manifest.json
