version: grokking_fit_v0.1

boundary:
  task: modular_addition
  modulus_p: 97
  dataset:
    train_size: 4000
    test_size: 2000
    corruption:
      enabled: true
      corruption_rate: 0.10
      corruption_seed: 123
  model:
    family: transformer
    layers: 2
    width: 128
    heads: 4
    dropout: 0.0
  training:
    optimizer: adamw
    lr: 1.0e-3
    weight_decay: 1.0e-2
    batch_size: 512
    max_steps: 300000

time:
  checkpoint_every_steps: 500
  window_W_checkpoints: 10
  hold_K_checkpoints: 5
  prediction_horizon_N_steps: 20000

seeds:
  explore: [0, 1, 2, 3, 4]
  eval: [100, 101, 102, 103, 104]

state:
  spectral_matrices:
    - "unembed.weight"

estimators:
  H_spec:
    normalize: true
  r_eff:
    enabled: true
  Correction_Rate:
    samples: 2048
    batch_size: 512

decision_rule:
  score:
    eps_hspec: 0.002
    theta_corr: 0.60
    w_hspec: 1.0
    w_corr: 1.0

evaluation:
  grok_event:
    metric: test_acc
    theta_grok: 0.95
    hold_K_checkpoints: 5
  primary_metrics:
    - "ROC_AUC"
    - "AveragePrecision"
    - "MeanLeadTimeAtFPR=0.05"

