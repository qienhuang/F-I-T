version: grokking_fit_v0.5_holdout_phase2_checkpoints
boundary:
  task: modular_addition
  modulus_p: 97
  dataset:
    train_size: 4000
    test_size: 2000
    corruption:
      enabled: true
      corruption_rate: 0.1
      corruption_seed: 123
  model:
    family: transformer
    layers: 2
    width: 128
    heads: 4
    dropout: 0.0
  training:
    optimizer: adamw
    lr: 0.001
    weight_decay: 0.01
    batch_size: 512
    max_steps: 300000
time:
  checkpoint_every_steps: 500
  window_W_checkpoints: 10
  hold_K_checkpoints: 5
  prediction_horizon_N_steps: 20000
  save_checkpoints: true
seeds:
  explore:
  - 0
  - 1
  - 2
  - 3
  - 4
  eval:
  - 141
  - 142
  - 143
  - 144
  - 147
  - 154
  - 158
  - 159
  - 163
  - 166
  - 168
  - 170
  - 174
state:
  spectral_matrices:
  - unembed.weight
estimators:
  H_spec:
    normalize: true
  r_eff:
    enabled: true
  Correction_Rate:
    samples: 2048
    batch_size: 512
decision_rule:
  score:
    score_sign: 1
    eps_hspec: 0.002
    theta_corr: 0.6
    w_hspec: 1.0
    w_corr: 1.0
evaluation:
  event:
    type: jump
    jump:
      metric: test_acc
      w_jump: 2
      delta_jump: 0.04
      theta_floor: 0.85
      delta_back: 0.03
      hold_k: 5
  grok_event:
    metric: test_acc
    theta_grok: 0.92
    hold_K_checkpoints: 5
  primary_metrics:
  - ROC_AUC
  - AveragePrecision
  - MeanLeadTimeAtFPR=0.05
